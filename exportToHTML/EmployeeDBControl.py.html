<html>
<head>
<title>EmployeeDBControl.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #808080;}
.s4 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
EmployeeDBControl.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">sqlite3</span>
<span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">*</span>
<span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">ttk</span>
<span class="s0">from </span><span class="s1">tkinter </span><span class="s0">import </span><span class="s1">messagebox</span>
<span class="s0">from </span><span class="s1">PIL </span><span class="s0">import </span><span class="s1">ImageTk</span><span class="s0">,</span><span class="s1">Image</span>
<span class="s0">from </span><span class="s1">datetime </span><span class="s0">import </span><span class="s1">datetime</span>


<span class="s1">root = Tk()</span>
<span class="s1">root.title(</span><span class="s2">'Employee Database'</span><span class="s1">)</span>
<span class="s1">root.geometry(</span><span class="s2">&quot;800x600&quot;</span><span class="s1">)</span>
<span class="s1">root.iconbitmap()</span>


<span class="s3">#Connect to the database for employees</span>
<span class="s1">connection = sqlite3.connect(</span><span class="s2">'Employ_Database.db'</span><span class="s1">)</span>
<span class="s3">#Create the cursor for the employee database</span>
<span class="s1">cursor = connection.cursor()</span>
<span class="s3">#Create The Table in the employee database if its not already there.</span>
<span class="s1">crttbl = </span><span class="s2">&quot;&quot;&quot;CREATE TABLE IF NOT EXISTS 
Employees(Name TEXT PRIMARY KEY, Job_Title TEXT, Date_Of_Hire TEXT)&quot;&quot;&quot;</span>
<span class="s1">cursor.execute(crttbl)</span>

<span class="s3">#Connect to login database for user authentication</span>
<span class="s1">conn2 = sqlite3.connect(</span><span class="s2">'Employ_Database.db'</span><span class="s1">)</span>
<span class="s1">cursor2 = conn2.cursor()</span>
<span class="s1">crttbl2 = </span><span class="s2">&quot;&quot;&quot;CREATE TABLE IF NOT EXISTS 
UserAuth(Username TEXT PRIMARY KEY, Password TEXT, Email TEXT)&quot;&quot;&quot;</span>
<span class="s1">cursor2.execute(crttbl2)</span>

<span class="s3">#Create the Table used for handling notifications</span>
<span class="s1">crttbl3 = </span><span class="s2">&quot;&quot;&quot;CREATE TABLE IF NOT EXISTS 
Notifications(Type TEXT,Details TEXT,Date Text)&quot;&quot;&quot;</span>
<span class="s1">cursor.execute(crttbl3)</span>
<span class="s1">usern = </span><span class="s2">&quot;Not Logged In&quot;</span>
<span class="s1">usernc = </span><span class="s2">&quot;Not Logged In&quot;</span>
<span class="s1">datalogger = []</span>

<span class="s3">#Clear all notifications</span>
<span class="s0">def </span><span class="s1">clearn():</span>
    <span class="s0">for </span><span class="s1">record </span><span class="s0">in </span><span class="s1">ntree.get_children():</span>
        <span class="s1">ntree.delete(record)</span>
    <span class="s1">connection = sqlite3.connect(</span><span class="s2">'Employ_Database.db'</span><span class="s1">)</span>
    <span class="s1">cursor = connection.cursor()</span>
    <span class="s1">cursor.execute(</span><span class="s2">&quot;DELETE FROM Notifications&quot;</span><span class="s1">)</span>
    <span class="s1">connection.commit()</span>
    <span class="s1">connection.close()</span>
    <span class="s1">messagebox.showinfo(</span><span class="s2">&quot;Success&quot;</span><span class="s0">,</span><span class="s2">&quot;Notifications cleared&quot;</span><span class="s1">)</span>

<span class="s3">#Create system notifications</span>
<span class="s0">def </span><span class="s1">notifsys(type</span><span class="s0">,</span><span class="s1">details</span><span class="s0">,</span><span class="s1">date):</span>
    <span class="s1">connection = sqlite3.connect(</span><span class="s2">'Employ_Database.db'</span><span class="s1">)</span>
    <span class="s1">cursor = connection.cursor()</span>

    <span class="s1">cursor.execute(</span><span class="s2">&quot;INSERT INTO Notifications VALUES (:ty, :det, :dt)&quot;</span><span class="s0">,</span>
                   <span class="s1">{</span>
                       <span class="s2">'ty'</span><span class="s1">: type</span><span class="s0">,</span>
                       <span class="s2">'det'</span><span class="s1">: details</span><span class="s0">,</span>
                       <span class="s2">'dt'</span><span class="s1">: date</span>
                   <span class="s1">}</span>
                <span class="s1">)</span>
    <span class="s1">ntree.insert(parent=</span><span class="s2">''</span><span class="s0">, </span><span class="s1">index=</span><span class="s2">'end'</span><span class="s0">, </span><span class="s1">iid=len(ntree.get_children())</span><span class="s0">, </span><span class="s1">values=(type</span><span class="s0">,</span><span class="s1">details</span><span class="s0">,</span><span class="s1">date))</span>

    <span class="s1">connection.commit()</span>
    <span class="s1">connection.close()</span>

<span class="s3">#On click event to get details of a row by double clicking</span>
<span class="s0">def </span><span class="s1">graber(event):</span>
    <span class="s1">clear_entries()</span>
    <span class="s1">selected = tree.focus()</span>
    <span class="s1">data = tree.item(selected</span><span class="s0">,</span><span class="s2">'values'</span><span class="s1">)</span>
    <span class="s1">nm.insert(</span><span class="s4">0</span><span class="s0">,</span><span class="s1">data[</span><span class="s4">1</span><span class="s1">])</span>
    <span class="s1">jbt.insert(</span><span class="s4">0</span><span class="s0">,</span><span class="s1">data[</span><span class="s4">2</span><span class="s1">])</span>
    <span class="s1">doh.insert(</span><span class="s4">0</span><span class="s0">,</span><span class="s1">data[</span><span class="s4">3</span><span class="s1">])</span>
    <span class="s1">id.insert(</span><span class="s4">0</span><span class="s0">,</span><span class="s1">data[</span><span class="s4">0</span><span class="s1">])</span>

<span class="s3">#Register function, to store a username,password and email to the database</span>
<span class="s0">def </span><span class="s1">register():</span>
    <span class="s1">conn2 = sqlite3.connect(</span><span class="s2">'Employ_Database.db'</span><span class="s1">)</span>
    <span class="s1">cursor2 = conn2.cursor()</span>

    <span class="s1">cursor.execute(</span><span class="s2">&quot;INSERT or REPLACE INTO UserAuth VALUES (:un, :ps, :em)&quot;</span><span class="s0">,</span>
                   <span class="s1">{</span>
                       <span class="s2">'un'</span><span class="s1">: loginuser.get()</span><span class="s0">,</span>
                       <span class="s2">'ps'</span><span class="s1">: loginpass.get()</span><span class="s0">,</span>
                       <span class="s2">'em'</span><span class="s1">: loginemail.get()</span>
                   <span class="s1">}</span>
                <span class="s1">)</span>
    <span class="s1">messagebox.showinfo(</span><span class="s2">&quot;Success&quot;</span><span class="s0">, </span><span class="s2">&quot;You have successfully Registered your information. Restart to log in.&quot;</span><span class="s1">)</span>
    <span class="s1">conn2.commit()</span>
    <span class="s1">conn2.close()</span>
    <span class="s0">return</span>

<span class="s3">#Allows a user to logout</span>
<span class="s0">def </span><span class="s1">logout():</span>
    <span class="s1">conn2 = sqlite3.connect(</span><span class="s2">'Login_Database.db'</span><span class="s1">)</span>
    <span class="s1">cursor2 = conn2.cursor()</span>
    <span class="s0">global </span><span class="s1">usern</span>
    <span class="s1">usern_label.config(text = usernc)</span>
    <span class="s1">logt_btn.grid_remove()</span>
    <span class="s1">regi_btn.grid(row=</span><span class="s4">5</span><span class="s0">, </span><span class="s1">column=</span><span class="s4">11</span><span class="s0">, </span><span class="s1">columnspan=</span><span class="s4">2</span><span class="s0">, </span><span class="s1">ipadx=</span><span class="s4">10</span><span class="s1">)</span>
    <span class="s1">loginuser_label.grid(row=</span><span class="s4">2</span><span class="s0">, </span><span class="s1">column=</span><span class="s4">8</span><span class="s1">)</span>
    <span class="s1">loginpass_label.grid(row=</span><span class="s4">3</span><span class="s0">, </span><span class="s1">column=</span><span class="s4">8</span><span class="s1">)</span>
    <span class="s1">loginemail_label.grid(row=</span><span class="s4">4</span><span class="s0">, </span><span class="s1">column=</span><span class="s4">8</span><span class="s1">)</span>
    <span class="s1">loginuser.grid(row=</span><span class="s4">2</span><span class="s0">, </span><span class="s1">column=</span><span class="s4">9</span><span class="s1">)</span>
    <span class="s1">loginpass.grid(row=</span><span class="s4">3</span><span class="s0">, </span><span class="s1">column=</span><span class="s4">9</span><span class="s1">)</span>
    <span class="s1">loginemail.grid(row=</span><span class="s4">4</span><span class="s0">, </span><span class="s1">column=</span><span class="s4">9</span><span class="s1">)</span>
    <span class="s1">logn_btn.grid(row=</span><span class="s4">5</span><span class="s0">, </span><span class="s1">column=</span><span class="s4">7</span><span class="s0">, </span><span class="s1">columnspan=</span><span class="s4">2</span><span class="s0">, </span><span class="s1">ipadx=</span><span class="s4">10</span><span class="s1">)</span>
    <span class="s1">messagebox.showinfo(</span><span class="s2">&quot;Success&quot;</span><span class="s0">, </span><span class="s2">&quot;You have successfully Logged out.&quot;</span><span class="s1">)</span>
    <span class="s1">usern = usernc</span>
    <span class="s1">conn2.commit()</span>
    <span class="s1">conn2.close()</span>

<span class="s3">#Login function</span>
<span class="s0">def </span><span class="s1">login():</span>
    <span class="s1">conn2 = sqlite3.connect(</span><span class="s2">'Employ_Database.db'</span><span class="s1">)</span>
    <span class="s1">cursor2 = conn2.cursor()</span>
    <span class="s0">global </span><span class="s1">usern</span>
    <span class="s1">hold = loginuser.get()</span>
    <span class="s1">cursor2.execute(</span><span class="s2">&quot;SELECT * FROM UserAuth&quot;</span><span class="s1">)</span>
    <span class="s1">records = cursor2.fetchall()</span>

    <span class="s1">i=</span><span class="s4">0</span>
    <span class="s3">#Check the username and password from the entry boxes</span>
    <span class="s0">for </span><span class="s1">record </span><span class="s0">in </span><span class="s1">records:</span>
        <span class="s0">if </span><span class="s1">record[</span><span class="s4">0</span><span class="s1">] == loginuser.get():</span>
            <span class="s1">print(record[</span><span class="s4">0</span><span class="s1">]==loginuser.get())</span>
            <span class="s0">if </span><span class="s1">record[</span><span class="s4">1</span><span class="s1">] != loginpass.get():</span>
                <span class="s1">conn2.commit()</span>
                <span class="s1">conn2.close()</span>
                <span class="s1">messagebox.showerror(</span><span class="s2">&quot;Error&quot;</span><span class="s0">,</span><span class="s2">&quot;Incorrect Username or password&quot;</span><span class="s1">)</span>
                <span class="s0">return</span>
            <span class="s1">i=</span><span class="s4">1</span>
            <span class="s1">usern = record[</span><span class="s4">0</span><span class="s1">]</span>
    <span class="s0">if </span><span class="s1">i == </span><span class="s4">0</span><span class="s1">:</span>
        <span class="s1">conn2.commit()</span>
        <span class="s1">conn2.close()</span>
        <span class="s1">messagebox.showerror(</span><span class="s2">&quot;Error&quot;</span><span class="s0">,</span><span class="s2">&quot;Incorrect Username or passowrd&quot;</span><span class="s1">)</span>
        <span class="s0">return</span>
    <span class="s1">messagebox.showinfo(</span><span class="s2">&quot;Success&quot;</span><span class="s0">,</span><span class="s2">&quot;You have successfully logged in.&quot;</span><span class="s1">)</span>
    <span class="s1">usern_label.config(text = str(usern))</span>
    <span class="s3">#Clean up and getting rid of unneeded elements</span>
    <span class="s1">loginuser.grid_remove()</span>
    <span class="s1">loginpass.grid_remove()</span>
    <span class="s1">loginemail.grid_remove()</span>
    <span class="s1">loginuser_label.grid_remove()</span>
    <span class="s1">loginpass_label.grid_remove()</span>
    <span class="s1">loginemail_label.grid_remove()</span>
    <span class="s1">logn_btn.grid_remove()</span>
    <span class="s1">regi_btn.grid_remove()</span>
    <span class="s1">logt_btn.grid(row=</span><span class="s4">5</span><span class="s0">, </span><span class="s1">column=</span><span class="s4">9</span><span class="s0">, </span><span class="s1">columnspan=</span><span class="s4">2</span><span class="s0">, </span><span class="s1">ipadx=</span><span class="s4">10</span><span class="s1">)</span>
    <span class="s1">conn2.commit()</span>
    <span class="s1">conn2.close()</span>

<span class="s3">#Add a employee to the system.</span>
<span class="s0">def </span><span class="s1">submit():</span>
    <span class="s1">connection = sqlite3.connect(</span><span class="s2">'Employ_Database.db'</span><span class="s1">)</span>
    <span class="s1">cursor = connection.cursor()</span>
    <span class="s0">if </span><span class="s1">usern == usernc:</span>
        <span class="s1">messagebox.showerror(</span><span class="s2">&quot;Not Logged in!&quot;</span><span class="s0">, </span><span class="s2">&quot;You have not logged in, please log in to continue&quot;</span><span class="s1">)</span>
        <span class="s1">connection.commit()</span>
        <span class="s1">connection.close()</span>
        <span class="s0">return</span>

    <span class="s3">#Add to the table</span>
    <span class="s1">cursor.execute(</span><span class="s2">&quot;INSERT or REPLACE INTO Employees VALUES (:nm, :jbt, :doh)&quot;</span><span class="s0">,</span>
                    <span class="s1">{</span>
                        <span class="s2">'nm'</span><span class="s1">: nm.get()</span><span class="s0">,</span>
                        <span class="s2">'jbt'</span><span class="s1">: jbt.get()</span><span class="s0">,</span>
                        <span class="s2">'doh'</span><span class="s1">: doh.get()</span>
                    <span class="s1">}</span>
                <span class="s1">)</span>

    <span class="s1">connection.commit()</span>
    <span class="s1">connection.close()</span>
    <span class="s1">messagebox.showinfo(</span><span class="s2">&quot;Success&quot;</span><span class="s0">,</span><span class="s2">&quot;Employee: &quot; </span><span class="s1">+ nm.get() + </span><span class="s2">&quot; Has been Successfully added.&quot;</span><span class="s1">)</span>
    <span class="s1">now = datetime.now()</span>
    <span class="s1">notifsys(</span><span class="s2">&quot;New Entry&quot;</span><span class="s0">,</span><span class="s2">&quot;Added Employee: &quot; </span><span class="s1">+ nm.get()</span><span class="s0">,</span><span class="s1">now.strftime(</span><span class="s2">&quot;%m-%d-%Y %H:%M:%S&quot;</span><span class="s1">))</span>
    <span class="s1">clear_entries()</span>

<span class="s3">#clear after entry</span>
<span class="s0">def </span><span class="s1">clear_entries():</span>

    <span class="s1">nm.delete(</span><span class="s4">0</span><span class="s0">,</span><span class="s1">END)</span>
    <span class="s1">jbt.delete(</span><span class="s4">0</span><span class="s0">,</span><span class="s1">END)</span>
    <span class="s1">doh.delete(</span><span class="s4">0</span><span class="s0">,</span><span class="s1">END)</span>
    <span class="s1">id.delete(</span><span class="s4">0</span><span class="s0">,</span><span class="s1">END)</span>



<span class="s3">#Remove an employee from the system</span>
<span class="s0">def </span><span class="s1">delete():</span>
    <span class="s1">connection = sqlite3.connect(</span><span class="s2">'Employ_Database.db'</span><span class="s1">)</span>
    <span class="s1">cursor = connection.cursor()</span>
    <span class="s3">#code to search database here based on id</span>

    <span class="s0">if </span><span class="s1">usern == usernc:</span>
        <span class="s1">messagebox.showerror(</span><span class="s2">&quot;Not Logged in!&quot;</span><span class="s0">, </span><span class="s2">&quot;You have not logged in, please log in to continue&quot;</span><span class="s1">)</span>
        <span class="s1">connection.commit()</span>
        <span class="s1">connection.close()</span>
        <span class="s0">return</span>

    <span class="s0">if </span><span class="s1">id.get() == </span><span class="s2">''</span><span class="s1">:</span>
        <span class="s1">connection.commit()</span>
        <span class="s1">connection.close()</span>
        <span class="s1">messagebox.showerror(</span><span class="s2">&quot;Error!&quot;</span><span class="s0">,</span><span class="s2">&quot;No Id Given&quot;</span><span class="s1">)</span>
        <span class="s0">return</span>

    <span class="s1">cursor.execute(</span><span class="s2">&quot;SELECT *  FROM Employees WHERE oid=&quot; </span><span class="s1">+ id.get())</span>
    <span class="s1">hold = cursor.fetchall()</span>
    <span class="s1">cursor.execute(</span><span class="s2">&quot;DELETE from Employees WHERE oid=&quot; </span><span class="s1">+ id.get())</span>
    <span class="s3">#SQL code to remove said found target from the database.</span>
    <span class="s1">connection.commit()</span>
    <span class="s1">connection.close()</span>
    <span class="s1">clear_entries()</span>
    <span class="s1">messagebox.showinfo(</span><span class="s2">&quot;Deleted!&quot;</span><span class="s0">,</span><span class="s1">hold[</span><span class="s4">0</span><span class="s1">][</span><span class="s4">0</span><span class="s1">] + </span><span class="s2">&quot; Has Been removed from the Database!&quot;</span><span class="s1">)</span>
    <span class="s1">now = datetime.now()</span>
    <span class="s1">notifsys(</span><span class="s2">&quot;Deletion&quot;</span><span class="s0">,</span><span class="s2">&quot;Removed Employee: &quot; </span><span class="s1">+ hold[</span><span class="s4">0</span><span class="s1">][</span><span class="s4">0</span><span class="s1">]</span><span class="s0">,</span><span class="s1">now.strftime(</span><span class="s2">&quot;%m-%d-%Y %H:%M:%S&quot;</span><span class="s1">))</span>

<span class="s3">#Refresh the table</span>
<span class="s0">def </span><span class="s1">refresher():</span>
    <span class="s3"># Connect to the database</span>
    <span class="s1">connection = sqlite3.connect(</span><span class="s2">'Employ_Database.db'</span><span class="s1">)</span>

    <span class="s3"># Create the cursor</span>
    <span class="s1">cursor = connection.cursor()</span>
    <span class="s1">cursor.execute(</span><span class="s2">&quot;SELECT oid,* FROM Employees&quot;</span><span class="s1">)</span>
    <span class="s1">records = cursor.fetchall()</span>
    <span class="s1">print_records = </span><span class="s2">''</span>
    <span class="s1">i=</span><span class="s4">0</span>



    <span class="s0">for </span><span class="s1">record </span><span class="s0">in </span><span class="s1">records:</span>
        <span class="s0">if </span><span class="s1">tree.exists(i):</span>
            <span class="s1">tree.delete(i)</span>
        <span class="s1">tree.insert(parent=</span><span class="s2">''</span><span class="s0">,</span><span class="s1">index=</span><span class="s2">'end'</span><span class="s0">,</span><span class="s1">iid=i</span><span class="s0">,</span><span class="s1">values=record)</span>
        <span class="s1">i=i+</span><span class="s4">1</span>
    <span class="s1">connection.commit()</span>
    <span class="s1">connection.close()</span>
 <span class="s3">#   tree.after(10000,refresher())</span>

<span class="s3">#Modify an existing employee in the database</span>
<span class="s0">def </span><span class="s1">modify():</span>
    <span class="s1">connection = sqlite3.connect(</span><span class="s2">'Employ_Database.db'</span><span class="s1">)</span>
    <span class="s1">cursor = connection.cursor()</span>
    <span class="s0">if </span><span class="s1">usern == usernc:</span>
        <span class="s1">messagebox.showerror(</span><span class="s2">&quot;Not Logged in!&quot;</span><span class="s0">,</span><span class="s2">&quot;You have not logged in, please log in to continue&quot;</span><span class="s1">)</span>
        <span class="s1">connection.commit()</span>
        <span class="s1">connection.close()</span>
        <span class="s0">return</span>


<span class="s3">#    hold = cursor.fetchall()</span>
    <span class="s1">cursor.execute(</span><span class="s2">&quot;&quot;&quot;UPDATE Employees SET 
        Name = :name, 
        Job_Title = :jobt, 
        Date_Of_Hire = :date 
         
        WHERE oid = :oid&quot;&quot;&quot;</span><span class="s0">,</span>
        <span class="s1">{</span>
            <span class="s2">'name'</span><span class="s1">: nm.get()</span><span class="s0">,</span>
            <span class="s2">'jobt'</span><span class="s1">: jbt.get()</span><span class="s0">,</span>
            <span class="s2">'date'</span><span class="s1">: doh.get()</span><span class="s0">,</span>
            <span class="s2">'oid'</span><span class="s1">: id.get()</span>
        <span class="s1">}</span>
        <span class="s1">)</span>
    <span class="s1">now = datetime.now()</span>
    <span class="s1">notifsys(</span><span class="s2">&quot;Update Entry&quot;</span><span class="s0">,</span><span class="s2">&quot;Updated Employee: &quot; </span><span class="s1">+ nm.get()</span><span class="s0">,</span><span class="s1">now.strftime(</span><span class="s2">&quot;%m-%d-%Y %H:%M:%S&quot;</span><span class="s1">))</span>
    <span class="s1">messagebox.showinfo(</span><span class="s2">&quot;Success&quot;</span><span class="s0">,</span><span class="s2">&quot;Employee &quot; </span><span class="s1">+ nm.get() + </span><span class="s2">&quot; Has been updated&quot;</span><span class="s1">)</span>
    <span class="s1">connection.commit()</span>
    <span class="s1">connection.close()</span>



<span class="s3">#Create textboxes</span>
<span class="s1">nm = Entry(root</span><span class="s0">, </span><span class="s1">width=</span><span class="s4">30</span><span class="s1">)</span>
<span class="s1">nm.grid(row=</span><span class="s4">0</span><span class="s0">, </span><span class="s1">column=</span><span class="s4">1</span><span class="s0">, </span><span class="s1">padx=</span><span class="s4">10</span><span class="s1">)</span>

<span class="s1">jbt = Entry(root</span><span class="s0">, </span><span class="s1">width=</span><span class="s4">30</span><span class="s1">)</span>
<span class="s1">jbt.grid(row=</span><span class="s4">1</span><span class="s0">, </span><span class="s1">column=</span><span class="s4">1</span><span class="s1">)</span>

<span class="s1">doh = Entry(root</span><span class="s0">, </span><span class="s1">width=</span><span class="s4">30</span><span class="s1">)</span>
<span class="s1">doh.grid(row=</span><span class="s4">2</span><span class="s0">, </span><span class="s1">column=</span><span class="s4">1</span><span class="s1">)</span>

<span class="s1">id = Entry(root</span><span class="s0">,</span><span class="s1">width=</span><span class="s4">10</span><span class="s1">)</span>
<span class="s1">id.grid(row=</span><span class="s4">3</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">1</span><span class="s0">, </span><span class="s1">pady=</span><span class="s4">10</span><span class="s1">)</span>

<span class="s1">loginuser = Entry(root</span><span class="s0">,</span><span class="s1">width=</span><span class="s4">20</span><span class="s1">)</span>
<span class="s1">loginuser.grid(row=</span><span class="s4">2</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">9</span><span class="s1">)</span>

<span class="s1">loginpass = Entry(root</span><span class="s0">,</span><span class="s1">width=</span><span class="s4">20</span><span class="s1">)</span>
<span class="s1">loginpass.grid(row=</span><span class="s4">3</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">9</span><span class="s1">)</span>

<span class="s1">loginemail = Entry(root</span><span class="s0">,</span><span class="s1">width=</span><span class="s4">20</span><span class="s1">)</span>
<span class="s1">loginemail.grid(row=</span><span class="s4">4</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">9</span><span class="s1">)</span>

<span class="s3">#loginemailn = Entry(root,width=20)</span>
<span class="s3">#loginemailn.grid()</span>

<span class="s3">#Create labels</span>

<span class="s1">nm_label = Label(root</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;Name&quot;</span><span class="s1">)</span>
<span class="s1">nm_label.grid(row=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">0</span><span class="s1">)</span>

<span class="s1">jbt_label = Label(root</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;Job Title&quot;</span><span class="s1">)</span>
<span class="s1">jbt_label.grid(row=</span><span class="s4">1</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">0</span><span class="s1">)</span>

<span class="s1">doh_label = Label(root</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;Date of Hire&quot;</span><span class="s1">)</span>
<span class="s1">doh_label.grid(row=</span><span class="s4">2</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">0</span><span class="s1">)</span>

<span class="s1">id_label = Label(root</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;ID of Employee to Modify or Delete&quot;</span><span class="s1">)</span>
<span class="s1">id_label.grid(row=</span><span class="s4">3</span><span class="s0">, </span><span class="s1">column=</span><span class="s4">0</span><span class="s1">)</span>

<span class="s1">user_label = Label(root</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;User: &quot;</span><span class="s1">)</span>
<span class="s1">user_label.grid(row=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">6</span><span class="s0">,</span><span class="s1">padx=</span><span class="s4">10</span><span class="s1">)</span>

<span class="s1">usern_label = Label(root</span><span class="s0">, </span><span class="s1">text=usern)</span>
<span class="s1">usern_label.grid(row=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">8</span><span class="s1">)</span>

<span class="s1">loginuser_label = Label(root</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;Username&quot;</span><span class="s1">)</span>
<span class="s1">loginuser_label.grid(row=</span><span class="s4">2</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">8</span><span class="s1">)</span>

<span class="s1">loginpass_label = Label(root</span><span class="s0">,</span><span class="s1">text=</span><span class="s2">&quot;Password&quot;</span><span class="s1">)</span>
<span class="s1">loginpass_label.grid(row=</span><span class="s4">3</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">8</span><span class="s1">)</span>

<span class="s1">loginemail_label = Label(root</span><span class="s0">,</span><span class="s1">text=</span><span class="s2">&quot;Email&quot;</span><span class="s1">)</span>
<span class="s1">loginemail_label.grid(row=</span><span class="s4">4</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">8</span><span class="s1">)</span>

<span class="s1">notif_label = Label(root</span><span class="s0">,</span><span class="s1">text=</span><span class="s2">&quot;-------------Notifications--------------&quot;</span><span class="s1">)</span>
<span class="s1">notif_label.grid(row=</span><span class="s4">7</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">7</span><span class="s0">,</span><span class="s1">columnspan=</span><span class="s4">6</span><span class="s1">)</span>

<span class="s3">#Submit Button</span>

<span class="s1">sbmt_btn = Button(root</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;Add New Entry to Database&quot;</span><span class="s0">, </span><span class="s1">command=submit)</span>
<span class="s1">sbmt_btn.grid(row=</span><span class="s4">4</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">columnspan=</span><span class="s4">2</span><span class="s0">, </span><span class="s1">pady=</span><span class="s4">0</span><span class="s0">, </span><span class="s1">padx=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">ipadx=</span><span class="s4">100</span><span class="s1">)</span>

<span class="s3">#Query Button</span>
<span class="s1">qry_btn = Button(root</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;Refresh the Table&quot;</span><span class="s0">,</span><span class="s1">command=refresher)</span>
<span class="s1">qry_btn.grid(row=</span><span class="s4">6</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">columnspan=</span><span class="s4">2</span><span class="s0">, </span><span class="s1">pady=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">padx=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">ipadx=</span><span class="s4">137</span><span class="s1">)</span>

<span class="s3">#Delete Button</span>
<span class="s1">dlt_btn = Button(root</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;Delete Record&quot;</span><span class="s0">, </span><span class="s1">command=delete)</span>
<span class="s1">dlt_btn.grid(row=</span><span class="s4">5</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">0</span><span class="s0">,</span><span class="s1">columnspan=</span><span class="s4">1</span><span class="s0">, </span><span class="s1">pady=</span><span class="s4">10</span><span class="s0">,</span><span class="s1">padx=</span><span class="s4">10</span><span class="s0">,</span><span class="s1">ipadx=</span><span class="s4">20</span><span class="s1">)</span>

<span class="s3">#Update Button</span>
<span class="s1">updt_btn = Button(root</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;Update Employee&quot;</span><span class="s0">,</span><span class="s1">command=modify)</span>
<span class="s1">updt_btn.grid(row=</span><span class="s4">5</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">1</span><span class="s0">,</span><span class="s1">columnspan=</span><span class="s4">1</span><span class="s0">,</span><span class="s1">pady=</span><span class="s4">10</span><span class="s0">,</span><span class="s1">padx=</span><span class="s4">10</span><span class="s0">,</span><span class="s1">ipadx=</span><span class="s4">20</span><span class="s1">)</span>
<span class="s3">#Login Button</span>
<span class="s1">logn_btn = Button(root</span><span class="s0">, </span><span class="s1">text= </span><span class="s2">&quot;Login&quot;</span><span class="s0">, </span><span class="s1">command=login)</span>
<span class="s1">logn_btn.grid(row=</span><span class="s4">5</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">7</span><span class="s0">,</span><span class="s1">columnspan=</span><span class="s4">2</span><span class="s0">,</span><span class="s1">ipadx=</span><span class="s4">10</span><span class="s1">)</span>

<span class="s3">#Logout button, not initially added</span>
<span class="s1">logt_btn = Button(root</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;Logout&quot;</span><span class="s0">,</span><span class="s1">command=logout)</span>
<span class="s3">#logt_btn.grid(row=5,column=9,columnspan=2,ipadx=10)</span>

<span class="s3">#Register button</span>
<span class="s1">regi_btn = Button(root</span><span class="s0">,</span><span class="s1">text = </span><span class="s2">&quot;Register&quot;</span><span class="s0">,</span><span class="s1">command=register)</span>
<span class="s1">regi_btn.grid(row=</span><span class="s4">5</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">9</span><span class="s0">,</span><span class="s1">columnspan=</span><span class="s4">2</span><span class="s0">,</span><span class="s1">ipadx=</span><span class="s4">10</span><span class="s1">)</span>

<span class="s3">#Clear all notifications</span>
<span class="s1">clrn_btn = Button(root</span><span class="s0">,</span><span class="s1">text = </span><span class="s2">&quot;Clear all Notifications&quot;</span><span class="s0">,</span><span class="s1">command=clearn)</span>
<span class="s1">clrn_btn.grid(row=</span><span class="s4">6</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">8</span><span class="s0">,</span><span class="s1">columnspan=</span><span class="s4">2</span><span class="s1">)</span>

<span class="s3">#Create Tree/Table</span>
<span class="s1">tree = ttk.Treeview(root)</span>

<span class="s3">#Column Definition</span>
<span class="s1">tree[</span><span class="s2">'columns'</span><span class="s1">] = (</span><span class="s2">&quot;ID&quot;</span><span class="s0">,</span><span class="s2">&quot;Name&quot;</span><span class="s0">,</span><span class="s2">&quot;Job Title&quot;</span><span class="s0">,</span><span class="s2">&quot;Date of Hire&quot;</span><span class="s1">)</span>

<span class="s1">tree.column(</span><span class="s2">&quot;#0&quot;</span><span class="s0">,</span><span class="s1">width=</span><span class="s4">0</span><span class="s0">, </span><span class="s1">minwidth=</span><span class="s4">0</span><span class="s1">)</span>
<span class="s1">tree.column(</span><span class="s2">&quot;ID&quot;</span><span class="s0">,</span><span class="s1">anchor=W</span><span class="s0">,</span><span class="s1">width=</span><span class="s4">20</span><span class="s1">)</span>
<span class="s1">tree.column(</span><span class="s2">&quot;Name&quot;</span><span class="s0">, </span><span class="s1">anchor=W</span><span class="s0">,</span><span class="s1">width=</span><span class="s4">120</span><span class="s1">)</span>
<span class="s1">tree.column(</span><span class="s2">&quot;Job Title&quot;</span><span class="s0">,</span><span class="s1">anchor=W</span><span class="s0">,</span><span class="s1">width=</span><span class="s4">120</span><span class="s1">)</span>
<span class="s1">tree.column(</span><span class="s2">&quot;Date of Hire&quot;</span><span class="s0">,</span><span class="s1">anchor=W</span><span class="s0">,</span><span class="s1">width=</span><span class="s4">120</span><span class="s1">)</span>

<span class="s3">#Headings</span>
<span class="s1">tree.heading(</span><span class="s2">&quot;#0&quot;</span><span class="s0">,</span><span class="s1">text=</span><span class="s2">&quot;Phantom Column&quot;</span><span class="s0">, </span><span class="s1">anchor=W)</span>
<span class="s1">tree.heading(</span><span class="s2">&quot;ID&quot;</span><span class="s0">,</span><span class="s1">text=</span><span class="s2">&quot;ID&quot;</span><span class="s0">,</span><span class="s1">anchor=W)</span>
<span class="s1">tree.heading(</span><span class="s2">&quot;Name&quot;</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;Name&quot;</span><span class="s0">,</span><span class="s1">anchor=W)</span>
<span class="s1">tree.heading(</span><span class="s2">&quot;Job Title&quot;</span><span class="s0">,</span><span class="s1">text =</span><span class="s2">&quot;Job Title&quot;</span><span class="s0">,</span><span class="s1">anchor=W)</span>
<span class="s1">tree.heading(</span><span class="s2">&quot;Date of Hire&quot;</span><span class="s0">,</span><span class="s1">text=</span><span class="s2">&quot;Date of Hire&quot;</span><span class="s0">,</span><span class="s1">anchor=W)</span>

<span class="s3">#Add datebase to Table</span>

<span class="s1">cursor.execute(</span><span class="s2">&quot;SELECT oid,* FROM Employees&quot;</span><span class="s1">)</span>
<span class="s1">records = cursor.fetchall()</span>
<span class="s1">print_records = </span><span class="s2">''</span>
<span class="s1">i = </span><span class="s4">0</span>
<span class="s0">for </span><span class="s1">record </span><span class="s0">in </span><span class="s1">records:</span>
    <span class="s1">tree.insert(parent=</span><span class="s2">''</span><span class="s0">, </span><span class="s1">index=</span><span class="s2">'end'</span><span class="s0">, </span><span class="s1">iid=i</span><span class="s0">, </span><span class="s1">values=record)</span>
    <span class="s1">i = i + </span><span class="s4">1</span>
<span class="s1">tree.grid(row=</span><span class="s4">8</span><span class="s0">, </span><span class="s1">column=</span><span class="s4">0</span><span class="s0">, </span><span class="s1">columnspan=</span><span class="s4">5</span><span class="s1">)</span>

<span class="s3">#Notifcation tree</span>
<span class="s1">ntree = ttk.Treeview(root)</span>

<span class="s1">ntree[</span><span class="s2">'columns'</span><span class="s1">] = (</span><span class="s2">'Type'</span><span class="s0">,</span><span class="s2">'Details'</span><span class="s0">,</span><span class="s2">'Date'</span><span class="s1">)</span>

<span class="s1">ntree.column(</span><span class="s2">&quot;#0&quot;</span><span class="s0">,</span><span class="s1">width=</span><span class="s4">0</span><span class="s0">, </span><span class="s1">minwidth=</span><span class="s4">0</span><span class="s1">)</span>
<span class="s1">ntree.column(</span><span class="s2">&quot;Type&quot;</span><span class="s0">,</span><span class="s1">width=</span><span class="s4">70</span><span class="s0">,</span><span class="s1">minwidth=</span><span class="s4">50</span><span class="s1">)</span>
<span class="s1">ntree.column(</span><span class="s2">&quot;Details&quot;</span><span class="s0">,</span><span class="s1">width=</span><span class="s4">150</span><span class="s0">,</span><span class="s1">minwidth=</span><span class="s4">100</span><span class="s1">)</span>
<span class="s1">ntree.column(</span><span class="s2">&quot;Date&quot;</span><span class="s0">,</span><span class="s1">width=</span><span class="s4">100</span><span class="s0">,</span><span class="s1">minwidth=</span><span class="s4">25</span><span class="s1">)</span>

<span class="s1">ntree.heading(</span><span class="s2">&quot;#0&quot;</span><span class="s0">,</span><span class="s1">text=</span><span class="s2">&quot;Phantom Column&quot;</span><span class="s0">,</span><span class="s1">anchor=W)</span>
<span class="s1">ntree.heading(</span><span class="s2">&quot;Type&quot;</span><span class="s0">,</span><span class="s1">text=</span><span class="s2">&quot;Type&quot;</span><span class="s0">,</span><span class="s1">anchor=W)</span>
<span class="s1">ntree.heading(</span><span class="s2">&quot;Details&quot;</span><span class="s0">,</span><span class="s1">text=</span><span class="s2">&quot;Details&quot;</span><span class="s0">,</span><span class="s1">anchor=W)</span>
<span class="s1">ntree.heading(</span><span class="s2">&quot;Date&quot;</span><span class="s0">,</span><span class="s1">text=</span><span class="s2">&quot;M/D/Y&quot;</span><span class="s0">,</span><span class="s1">anchor=W)</span>

<span class="s1">ntree.grid(row=</span><span class="s4">8</span><span class="s0">,</span><span class="s1">column=</span><span class="s4">8</span><span class="s0">,</span><span class="s1">columnspan=</span><span class="s4">5</span><span class="s1">)</span>

<span class="s1">cursor.execute(</span><span class="s2">&quot;SELECT * FROM Notifications&quot;</span><span class="s1">)</span>
<span class="s1">records = cursor.fetchall()</span>
<span class="s1">i = </span><span class="s4">0</span>
<span class="s0">for </span><span class="s1">record </span><span class="s0">in </span><span class="s1">records:</span>
    <span class="s1">print(record)</span>
    <span class="s1">ntree.insert(parent=</span><span class="s2">''</span><span class="s0">,</span><span class="s1">index=</span><span class="s2">'end'</span><span class="s0">,</span><span class="s1">iid=len(ntree.get_children())</span><span class="s0">,</span><span class="s1">values=record)</span>
    <span class="s1">i=i+</span><span class="s4">1</span>

<span class="s3">#add data to tree</span>

<span class="s3"># Binds!</span>
<span class="s1">tree.bind(</span><span class="s2">&quot;&lt;Double-1&gt;&quot;</span><span class="s0">, </span><span class="s1">graber)</span>




<span class="s1">root.mainloop()</span>

<span class="s1">connection.commit()</span>
<span class="s1">connection.close()</span></pre>
</body>
</html>